---
title: "11-05-19 Univariate Anaysis"
author: "Megan Beaudry"
date: "11/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load library}
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(dplyr)
```



```{r pressure, echo=FALSE}
clean_water_quality_data <- readRDS("../../data/processed_data/clean_water_quality_data.rds")
cleandata <- clean_water_quality_data 
```


Summary Statistics
Here are the summary statistics for each of the important variables
```{r}
summary(clean_water_quality_data$Rainfall)
summary(clean_water_quality_data$HF183)
summary(clean_water_quality_data$HumM2)
summary(clean_water_quality_data$CG01)
summary(clean_water_quality_data$LeeSg)
summary(clean_water_quality_data$Dog3)
summary(clean_water_quality_data$MuBac)
summary(clean_water_quality_data$Rum2Bac)
summary(clean_water_quality_data$A_butlzeri_HSP60)
summary(clean_water_quality_data$Salmonella_spp_InvA)
summary(clean_water_quality_data$Campylobacter_spp_Van_Dkye)
summary(clean_water_quality_data$Enterococcus_CCE)
summary(clean_water_quality_data$total_coliforms)
summary(clean_water_quality_data$E_coli)
summary(clean_water_quality_data$Enteroalert)
```

```{r}
library(Hmisc)
describe(cleandata)
```


Summary stats table for publication
```{r list of summary stats}
library(dplyr)
library(magrittr)
library(qwraps2)
options(qwraps2_markup = "markdown")

args(summary_table)

our_summary2 <-
  list("Human HF183" =
       list("min" = ~ min(cleandata$HF183),
            "max" = ~ max(cleandata$HF183),
            "median" = ~ median(cleandata$HF183)),
       "Human HumM2" =
       list("min" = ~ min(cleandata$HumM2),
            "median" = ~ median(cleandata$HumM2),
            "max" = ~ max(cleandata$Humm2)),
       "Arcobacter spp. HSP60" =
       list("min" = ~ min(cleandata$A_butzleri_HSP60),
            "max" = ~ max(cleandata$A_butzleri_HSP60),
            "median" = ~ median(cleandata$A_butzleri_HSP60)),
       "Canada Goose CG01" =
       list("min" = ~ min(cleandata$CG01),
            "max"  = ~ max(cleandata$CG01),
            "median" = ~ median(cleandata$CG01))
       )

whole <- summary_table(cleandata, our_summary2)
whole

png("../../results/summarystats.png", height=400, width=400)
p<-tableGrob(whole)
grid.arrange(p)
dev.off()
```


```{r}
cleandata %>%
  dplyr::select(cleandata$HF183, cleandata$HumM2, cleandata$A_butzleri_HSP60) %>%
  qsummary(.)
  
```


BOX AND WHISKER PLOTS
Data: clean_water_quality_data
```{r Box and whisker HF183}
All_Box_HF183 <- ggplot(data = clean_water_quality_data, aes(x = "", y = HF183)) + 
  geom_boxplot() +
  facet_wrap(~ Pond) +
  theme_bw() + 
  labs (x = "HF183", y = "Log10 Copies/100mL")
All_Box_HF183
ggsave(filename = "../../results/All_Box_HF183.png", plot = All_Box_HF183)
```


```{r HF183 box and whisker by site}
McCall_bysite_box_HF183 <- clean_water_quality_data %>%
  filter(Pond == "McCall_Lake") %>%
  ggplot(aes(x = "", y = HF183)) + 
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 6)) +
  facet_wrap(~ Sampling_Site) +
  theme_bw() +
  labs (x = "HF183", y = "Log10 Copies/100mL")
McCall_bysite_box_HF183
ggsave(filename = "../../results/McCall_bysite_box_HF183.png", plot = McCall_bysite_box_HF183)


Country_Hills_bysite_box_HF183 <- clean_water_quality_data %>%
  filter(Pond == "Country_Hills") %>%
  ggplot(aes(x = "", y = HF183)) + 
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 6)) +
  facet_wrap(~ Sampling_Site) +
  theme_bw() +
  labs (x = "HF183", y = "Log10 Copies/100mL")
Country_Hills_bysite_box_HF183
ggsave(filename = "../../results/Country_Hills_bysite_box_HF183.png", plot = Country_Hills_bysite_box_HF183)

Inverness_bysite_box_HF183 <- clean_water_quality_data %>%
  filter(Pond == "Inverness") %>%
  ggplot(aes(x = "", y = HF183)) + 
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 6)) +
  facet_wrap(~ Sampling_Site) +
  theme_bw() +
  labs (x = "HF183", y = "Log10 Copies/100mL")
Inverness_bysite_box_HF183
ggsave(filename = "../../results/Inverness_bysite_box_HF183.png", plot = Inverness_bysite_box_HF183)
```


```{r}

```


